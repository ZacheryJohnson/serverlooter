<!doctype html>
<html lang="en">
    <head>
        <style>
            body {
                margin: 0;
                background-color: #1b1b1b;
                overflow: hidden;
            }

            p {
                text-align: center;
                color: white;
            }

            #loading {
                display: grid;
                place-content: center;
                justify-items: center;
                gap: 20px;
            }

            .spinner {
                margin: 0;
                padding: 0;
                width: 40px;
                height: 40px;
                border: 4px solid rgba(255,255,255,0.1);
                border-left-color: #fff;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            @keyframes spin {
                to { transform: rotate(360deg); }
            }
        </style>
    </head>
    <body style="margin: 0px;">
        <div id="loading">
            <p>Loading game assets - this might take a second!</p>
            <div class="spinner"></div>
        </div>
        <script type="module">
            const loadingBlock = document.getElementById("loading");

            import init from './serverlooter-${GIT_HASH}.js';

            const wasm = await (await fetch('serverlooter_opt-${GIT_HASH}.wasm')).bytes();

            init(wasm).catch((error) => {
                if (!error.message.startsWith("Using exceptions for control flow, don't mind me. This isn't actually an error!")) {
                    loadingScreen.innerHTML = `<div style="color: #ff6b6b; text-align: center;">
                        <strong>Error loading game! Please refresh the page and try again.</strong><br><br>${error.message}
                    </div>`;
                    throw error;
                }
            }).then(() => {
                loadingBlock.remove();
            });
        </script>
    </body>
</html>